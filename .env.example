# =============================================================================
# Environment Configuration Template
# =============================================================================
# This file documents all security-related configuration settings with safe
# placeholder values. Copy this file to .env and update with actual values.
#
# SECURITY WARNING: Never commit .env files with actual secrets to version control.
# This .env.example file contains only safe placeholder/default values.
#
# Usage:
#   cp .env.example .env
#   # Edit .env with your actual configuration values
#
# =============================================================================

# -----------------------------------------------------------------------------
# Application Environment
# -----------------------------------------------------------------------------
# Options: development, production, test
#
# Security Rationale:
# - Controls security header strictness (production = stricter defaults)
# - Affects error message verbosity (production hides internal details)
# - Determines cookie security settings (production requires HTTPS)
#
# Development: Relaxed security for local testing
# Production: Maximum security enforcement
# -----------------------------------------------------------------------------
NODE_ENV=development

# -----------------------------------------------------------------------------
# Server Configuration
# -----------------------------------------------------------------------------
# The port number the server will listen on
#
# Security Rationale:
# - Use ports > 1024 in development (no root required)
# - Production typically uses 80/443 via reverse proxy
# - Avoid exposing application port directly in production
# -----------------------------------------------------------------------------
PORT=3000

# -----------------------------------------------------------------------------
# Rate Limiting Configuration (DoS Protection)
# -----------------------------------------------------------------------------
# OWASP Reference: A04:2021 - Insecure Design
#
# Rate limiting prevents:
# - Brute force attacks on authentication endpoints
# - Denial of Service (DoS) attacks
# - API abuse and scraping
# - Resource exhaustion attacks
#
# RATE_LIMIT_WINDOW_MS: Time window in milliseconds
# Default: 900000 (15 minutes)
# Production recommendation: 60000-900000 depending on use case
#
# RATE_LIMIT_MAX: Maximum requests per IP per window
# Default: 100 requests per 15 minutes
# Production recommendation: Adjust based on legitimate traffic patterns
# - Public API: 100-1000 requests/window
# - Authentication endpoints: 5-10 requests/window (stricter)
# -----------------------------------------------------------------------------
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX=100

# -----------------------------------------------------------------------------
# CORS (Cross-Origin Resource Sharing) Configuration
# -----------------------------------------------------------------------------
# OWASP Reference: A01:2021 - Broken Access Control
#
# CORS controls which origins can access your API:
# - Prevents unauthorized cross-origin requests
# - Mitigates Cross-Site Request Forgery (CSRF) attacks
# - Controls exposure of sensitive data to third-party sites
#
# CORS_ORIGIN: Allowed origin(s) for cross-origin requests
# Options:
#   - Single origin: http://localhost:3000
#   - Multiple origins: http://localhost:3000,https://app.example.com
#   - All origins (NOT recommended for production): *
#
# Security Rationale:
# - Always use explicit whitelist in production
# - Never use wildcard (*) with credentials enabled
# - Include only trusted domains
#
# CORS_CREDENTIALS: Allow credentials (cookies, auth headers) in CORS
# Options: true, false
#
# Security Rationale:
# - Enable only if your frontend needs to send cookies/auth headers
# - When true, CORS_ORIGIN cannot be "*" (wildcard)
# - Increases attack surface - enable only when necessary
# -----------------------------------------------------------------------------
CORS_ORIGIN=http://localhost:3000
CORS_CREDENTIALS=true

# -----------------------------------------------------------------------------
# Helmet.js Security Headers Configuration
# -----------------------------------------------------------------------------
# OWASP Reference: A05:2021 - Security Misconfiguration
#
# Helmet sets HTTP headers that protect against common web vulnerabilities:
# - Content-Security-Policy (CSP): Prevents XSS and data injection
# - X-Frame-Options: Prevents clickjacking
# - X-Content-Type-Options: Prevents MIME-sniffing
# - Strict-Transport-Security: Enforces HTTPS
# - And 10+ additional security headers
#
# HELMET_CSP_REPORT_ONLY: Content Security Policy mode
# Options: true (report violations only), false (enforce policy)
#
# Security Rationale:
# - Set to true initially to identify policy violations without breaking app
# - Set to false in production after CSP policy is validated
# - Monitor CSP reports to detect XSS attempts
#
# Development: true (test without breaking functionality)
# Production: false (enforce security policy)
# -----------------------------------------------------------------------------
HELMET_CSP_REPORT_ONLY=false

# -----------------------------------------------------------------------------
# HSTS (HTTP Strict Transport Security) Configuration
# -----------------------------------------------------------------------------
# OWASP Reference: A02:2021 - Cryptographic Failures
#
# HSTS forces browsers to only connect via HTTPS:
# - Prevents protocol downgrade attacks
# - Protects against man-in-the-middle (MitM) attacks
# - Automatically upgrades HTTP links to HTTPS
#
# HSTS_MAX_AGE: Duration (in seconds) browser remembers HTTPS-only rule
#
# Recommended values:
# - Testing: 86400 (1 day)
# - Staging: 604800 (1 week)
# - Production: 31536000 (1 year) or 63072000 (2 years)
#
# Security Rationale:
# - Longer max-age = stronger protection but harder to disable
# - Start with shorter duration during initial deployment
# - Increase to 1-2 years once HTTPS is verified working
#
# WARNING: Only enable HSTS when you have valid TLS certificates.
# Misconfigured HSTS can make your site inaccessible.
# -----------------------------------------------------------------------------
HSTS_MAX_AGE=31536000

# -----------------------------------------------------------------------------
# Request Body Size Limit (Payload Attack Protection)
# -----------------------------------------------------------------------------
# OWASP Reference: A03:2021 - Injection
#
# Limits maximum request body size to prevent:
# - Denial of Service via large payload attacks
# - Memory exhaustion attacks
# - Buffer overflow vulnerabilities
# - Slow POST attacks
#
# BODY_LIMIT: Maximum allowed request body size
# Supported formats: b (bytes), kb, mb, gb
#
# Recommended values:
# - JSON APIs: 10kb - 100kb
# - File uploads: Configure separately with multer or similar
# - Form submissions: 1kb - 50kb
#
# Security Rationale:
# - Set as small as possible while supporting legitimate requests
# - Separate limits for different routes if needed
# - Log rejected oversized requests for monitoring
# -----------------------------------------------------------------------------
BODY_LIMIT=10kb

# -----------------------------------------------------------------------------
# TLS/SSL Configuration (Production HTTPS)
# -----------------------------------------------------------------------------
# OWASP Reference: A02:2021 - Cryptographic Failures
#
# TLS encryption protects data in transit:
# - Encrypts all communication between client and server
# - Prevents eavesdropping and data interception
# - Required for HSTS, secure cookies, and modern browser features
#
# Security Rationale:
# - Always use TLS 1.2+ (TLS 1.3 recommended)
# - Use certificates from trusted Certificate Authority
# - Regularly rotate certificates before expiration
# - Store private keys securely with restricted permissions
#
# Development: Typically not required (use HTTP localhost)
# Production: Required - configure via reverse proxy or application
#
# Uncomment and configure these in production:
# -----------------------------------------------------------------------------
# TLS_CERT_PATH=/path/to/fullchain.pem
# TLS_KEY_PATH=/path/to/privkey.pem

# -----------------------------------------------------------------------------
# Additional Security Configuration (Optional)
# -----------------------------------------------------------------------------
# Uncomment and configure as needed for your application:

# Session Secret (if using sessions)
# Generate with: node -e "console.log(require('crypto').randomBytes(64).toString('hex'))"
# SESSION_SECRET=your-super-secret-session-key-min-64-characters-long

# Cookie Security Settings
# COOKIE_SECURE=true        # Require HTTPS for cookies (production)
# COOKIE_HTTP_ONLY=true     # Prevent JavaScript access to cookies
# COOKIE_SAME_SITE=strict   # CSRF protection (strict, lax, none)

# API Key for external services (if needed)
# API_KEY=your-api-key-here

# Trusted Proxy Configuration (when behind load balancer/reverse proxy)
# TRUST_PROXY=1             # Trust first proxy
# TRUST_PROXY=loopback      # Trust localhost proxies

# Logging Level
# LOG_LEVEL=info            # Options: error, warn, info, debug

# =============================================================================
# SECURITY CHECKLIST BEFORE PRODUCTION DEPLOYMENT
# =============================================================================
# [ ] NODE_ENV set to "production"
# [ ] Rate limiting configured appropriately for expected traffic
# [ ] CORS_ORIGIN contains only trusted, specific domains (no wildcards)
# [ ] HELMET_CSP_REPORT_ONLY set to false
# [ ] HSTS_MAX_AGE set to 31536000 (1 year) or higher
# [ ] TLS certificates configured and valid
# [ ] All secrets are strong, randomly generated values
# [ ] .env file has restrictive file permissions (chmod 600)
# [ ] .env is in .gitignore and NOT committed to version control
# =============================================================================
